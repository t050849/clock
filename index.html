<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>iPad 2 æ™ºæ…§ç¯€æ…¶æ™‚é˜ - ä½ˆå±€ä¿®æ­£ç‰ˆ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body, html {
            width: 100%; height: 100%;
            background-color: #000000;
            font-family: Helvetica, Arial, sans-serif;
            overflow: hidden;
        }

        /* é ‚éƒ¨å€åŸŸå‘ä¸‹ç§»å‹•ï¼Œé¿å…æ”¾å¤§å¾Œè·‘å‡ºç•«é¢ */
        .top-section { position: absolute; top: 60px; left: 40px; }
        .bottom-section { position: absolute; bottom: 40px; left: 40px; right: 40px; }

        .middle-section { 
            position: absolute; top: 50%; left: 0; width: 100%; text-align: center;
            -webkit-transform: translateY(-50%); transform: translateY(-50%);
        }

        .date-container { display: flex; flex-direction: column; }
        .date-display { 
            font-size: 32px; color: #FFFF00; font-weight: bold; line-height: 1.1;
            -webkit-transform-origin: left top; transform-origin: left top;
        }
        .lunar-display { 
            font-size: 22px; color: #FFFF00; font-weight: bold; line-height: 1.1; margin-top: 5px;
            -webkit-transform-origin: left top; transform-origin: left top;
        }
        
        .holiday-red { color: #FF0000 !important; }

        .time-display { 
            font-size: 160px; color: #FFFFFF; font-weight: bold; white-space: nowrap; 
            display: inline-block; -webkit-transform-origin: center center; transform-origin: center center;
        }

        .weather-display { 
            font-size: 28px; color: #FFFF00; font-weight: bold; display: flex; align-items: center; 
            -webkit-transform-origin: left bottom; transform-origin: left bottom;
        }
        
        /* èª¿æ•´é–“è·ï¼Œé…åˆæ–°çš„æ’åº */
        .location-text { margin-right: 10px; }
        .temp-text { margin-right: 15px; }
        .weather-icon { display: inline-block; margin-right: 10px; font-size: 1.2em; }
        .rain-chance { color: #00CED1; font-size: 0.9em; }

        .control-button {
            position: absolute; bottom: 0; right: 0; width: 30px; height: 30px; 
            background: rgba(255,255,0,0.1); border: 1px solid rgba(255,255,0,0.3); border-radius: 15px;
        }

        .main-popup {
            position: absolute; bottom: 40px; right: 10px; background: rgba(10, 10, 10, 0.98); 
            border: 2px solid #FFFF00; padding: 15px; display: none; z-index: 1000; width: 300px;
            max-height: 85%; overflow-y: scroll; -webkit-overflow-scrolling: touch;
        }
        .show { display: block; }
        .section-title { color: #FFFF00; font-size: 13px; margin: 12px 0 8px; text-align: center; border-top: 1px dotted #444; padding-top: 10px; }
        .btn { background: #333; color: #FFFF00; border: 1px solid #FFFF00; padding: 8px; margin: 2px; border-radius: 4px; font-size: 14px; }
        .btn-sm { width: 45px; font-weight: bold; }
        .val-lab { color: #fff; font-size: 12px; min-width: 40px; display: inline-block; }
        .color-row { text-align: center; margin-bottom: 5px; }
        .swatch { display: inline-block; width: 30px; height: 30px; margin: 3px; border: 1px solid #666; border-radius: 3px; }
    </style>
</head>
<body>

    <div class="top-section">
        <div class="date-container">
            <div id="dateDisplay" class="date-display">è¼‰å…¥ä¸­...</div>
            <div id="lunarDisplay" class="lunar-display">è¼‰å…¥ä¸­...</div>
        </div>
    </div>

    <div class="middle-section">
        <div id="timeDisplay" class="time-display">00:00:00</div>
    </div>

    <div class="bottom-section">
        <div id="weatherDisplay" class="weather-display">
            <span class="location-text">ğŸ“¡ è®€å–ä¸­...</span>
        </div>
        <button id="controlBtn" class="control-button"></button>
    </div>

    <div id="mainPopup" class="main-popup">
        <button class="btn" style="width:100%" onclick="toggleFormat()">åˆ‡æ› 12/24H åˆ¶</button>
        <div class="section-title">æ™‚é–“æ¯”ä¾‹</div>
        <div class="color-row">
            å¯¬åº¦: <button class="btn btn-sm" onclick="adjTimeW(-0.05)">-</button>
            <span id="wLab" class="val-lab">100%</span>
            <button class="btn btn-sm" onclick="adjTimeW(0.05)">+</button>
        </div>
        <div class="color-row">
            é«˜åº¦: <button class="btn btn-sm" onclick="adjTimeH(-0.1)">-</button>
            <span id="hLab" class="val-lab">100%</span>
            <button class="btn btn-sm" onclick="adjTimeH(0.1)">+</button>
        </div>
        <div class="section-title">æ—¥æœŸ & å¤©æ°£ç¸®æ”¾</div>
        <div class="color-row">
            æ—¥æœŸ: <button class="btn btn-sm" onclick="adjScale('date', -0.1)">-</button>
            <span id="dateScaleLab" class="val-lab">100%</span>
            <button class="btn btn-sm" onclick="adjScale('date', 0.1)">+</button>
        </div>
        <div class="color-row">
            å¤©æ°£: <button class="btn btn-sm" onclick="adjScale('weather', -0.1)">-</button>
            <span id="weatherScaleLab" class="val-lab">100%</span>
            <button class="btn btn-sm" onclick="adjScale('weather', 0.1)">+</button>
        </div>
        <div class="section-title">å­—é«”é¡è‰²</div>
        <div id="palette1" class="color-row"></div>
        <div id="palette2" class="color-row"></div>
        <div id="palette3" class="color-row"></div>
        <button class="btn" style="width:100%; margin-top:20px; background:#400; color:#fff; border:none;" onclick="closeMenu()">å„²å­˜ä¸¦é—œé–‰</button>
    </div>

    <script>
        var is12H = true;
        var scaleX = 1.0, scaleY = 1.0;
        var dateScale = 1.0, weatherScale = 1.0;
        var colors = ['#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#FFFFFF', '#FF69B4', '#00CED1'];
        
        var tDiv = document.getElementById('timeDisplay');
        var dDiv = document.getElementById('dateDisplay');
        var lDiv = document.getElementById('lunarDisplay');
        var wDiv = document.getElementById('weatherDisplay');
        var menu = document.getElementById('mainPopup');

        var holidays = { "1-1": "å…ƒæ—¦", "2-28": "å’Œå¹³ç´€å¿µæ—¥", "4-4": "å…’ç«¥ç¯€", "4-5": "æ¸…æ˜ç¯€", "5-1": "å‹å‹•ç¯€", "10-10": "åœ‹æ…¶æ—¥" };

        function update() {
            var now = new Date();
            var m = now.getMonth() + 1, d = now.getDate(), dayOfWeek = now.getDay();
            var dayKey = m + "-" + d;
            var isHoliday = !!holidays[dayKey], isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);
            
            var days = ['é€±æ—¥', 'é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­'];
            var weekDaySpan = (isHoliday || isWeekend) ? '<span class="holiday-red">' + days[dayOfWeek] + '</span>' : days[dayOfWeek];
            dDiv.innerHTML = now.getFullYear() + 'å¹´' + m + 'æœˆ' + d + 'æ—¥ ' + weekDaySpan;
            
            // è¾²æ›†é‚è¼¯ç¤ºç¯„ (2026/3/1)
            var rocYear = now.getFullYear() - 1911;
            var lunarMonth = 1, lunarDay = 13; 
            var dayText = (lunarDay <= 10) ? ["åˆä¸€","åˆäºŒ","åˆä¸‰","åˆå››","åˆäº”","åˆå…­","åˆä¸ƒ","åˆå…«","åˆä¹","åˆå"][lunarDay-1] : lunarDay + "æ—¥";
            var holidayLabel = isHoliday ? ' <span class="holiday-red">(' + holidays[dayKey] + ')</span>' : "";
            lDiv.innerHTML = "è¾²æ›† " + rocYear + "å¹´" + lunarMonth + "æœˆ" + dayText + holidayLabel;

            var hh = now.getHours(), mm = now.getMinutes(), ss = now.getSeconds();
            var ampm = is12H ? (hh >= 12 ? "PM " : "AM ") : "";
            if (is12H) { hh = hh % 12; if (hh === 0) hh = 12; }
            if (hh < 10) hh = "0" + hh;
            if (mm < 10) mm = "0" + mm;
            if (ss < 10) ss = "0" + ss;
            tDiv.innerHTML = ampm + hh + ":" + mm + ":" + ss;
        }

        function adjScale(type, val) {
            if (type === 'date') {
                dateScale += val;
                var s = "scale(" + dateScale + ")";
                dDiv.style.webkitTransform = s; dDiv.style.transform = s;
                lDiv.style.webkitTransform = s; lDiv.style.transform = s;
                document.getElementById('dateScaleLab').innerHTML = Math.round(dateScale * 100) + '%';
            } else {
                weatherScale += val;
                var s = "scale(" + weatherScale + ")";
                wDiv.style.webkitTransform = s; wDiv.style.transform = s;
                document.getElementById('weatherScaleLab').innerHTML = Math.round(weatherScale * 100) + '%';
            }
        }

        function applyTransform() {
            var s = "scale(" + scaleX + "," + scaleY + ")";
            tDiv.style.webkitTransform = s; tDiv.style.transform = s;
            document.getElementById('wLab').innerHTML = Math.round(scaleX * 100) + '%';
            document.getElementById('hLab').innerHTML = Math.round(scaleY * 100) + '%';
        }

        function adjTimeW(v) { scaleX += v; applyTransform(); }
        function adjTimeH(v) { scaleY += v; applyTransform(); }
        function toggleFormat() { is12H = !is12H; update(); }
        
        function getWeatherIcon(desc) {
            if(desc.includes('æ™´')) return 'â˜€ï¸'; 
            if(desc.includes('å¤šé›²') || desc.includes('é™°')) return 'â˜ï¸'; 
            if(desc.includes('é›¨')) return 'â˜”'; 
            return 'âšª';
        }

        function getWeather() {
            var url = 'https://api.openweathermap.org/data/2.5/weather?lat=25.0074129&lon=121.2685473&appid=5d13f280068f27e7b123c2b25149a95c&units=metric&lang=zh_tw';
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var data = JSON.parse(xhr.responseText);
                    var temp = Math.round(data.main.temp);
                    var icon = getWeatherIcon(data.weather[0].description);
                    var rain = data.clouds ? data.clouds.all : 0;
                    
                    // é‡æ–°æ’åˆ—ï¼šæ–°èˆˆé‡Œ -> 22Â°C -> ICON -> é™é›¨æ©Ÿç‡
                    wDiv.innerHTML = 
                        '<span class="location-text">æ–°èˆˆé‡Œ</span>' +
                        '<span class="temp-text">' + temp + 'Â°C</span>' +
                        '<span class="weather-icon">' + icon + '</span>' +
                        '<span class="rain-chance">â˜” ' + rain + '%</span>';
                }
            };
            xhr.send();
        }

        function initPalettes() {
            for(var i=1; i<=3; i++) {
                var container = document.getElementById('palette' + i);
                for(var j=0; j<colors.length; j++) {
                    var s = document.createElement('div');
                    s.className = 'swatch'; s.style.backgroundColor = colors[j];
                    (function(t, c){
                        s.onclick = function() {
                            if(t === 1) { dDiv.style.color = c; lDiv.style.color = c; }
                            if(t === 2) tDiv.style.color = c;
                            if(t === 3) wDiv.style.color = c;
                        };
                    })(i, colors[j]);
                    container.appendChild(s);
                }
            }
        }

        document.getElementById('controlBtn').onclick = function(e) {
            e.stopPropagation();
            menu.className = (menu.className === "main-popup") ? "main-popup show" : "main-popup";
        };

        function closeMenu() { menu.className = "main-popup"; }

        initPalettes();
        setInterval(update, 1000);
        update();
        getWeather();
        setInterval(getWeather, 600000);
    </script>
</body>
</html>
